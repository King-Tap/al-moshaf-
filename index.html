<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ù…ØµØ­Ù Ø§Ù„Ø£ÙˆÙÙ„Ø§ÙŠÙ† Ø§Ù„Ù…Ø¶Ù…ÙˆÙ†</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Amiri&family=Tajawal:wght@500;800&display=swap" rel="stylesheet">
    <style>
        [v-cloak] { display: none !important; }
        body { font-family: 'Tajawal', sans-serif; background-color: #f0f2f5; }
        .quran-text { font-family: 'Amiri', serif; line-height: 2.5; font-size: 1.8rem; text-align: justify; }
        .btn-main { background-color: #064e3b; color: white; padding: 12px; border-radius: 12px; font-weight: bold; width: 100%; transition: 0.3s; }
        .card { background: white; border-radius: 16px; padding: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); border-right: 5px solid #064e3b; margin-bottom: 10px; }
    </style>
</head>
<body>
<div id="app" v-cloak>
    <header class="bg-[#064e3b] text-white p-4 sticky top-0 z-50 flex justify-between items-center">
        <h1 class="font-bold">ğŸ“– Ù…ØµØ­Ù Ø§Ù„Ø£ÙˆÙÙ„Ø§ÙŠÙ†</h1>
        <div class="flex gap-2">
            <button @click="view = 'index'" class="text-xs bg-[#053e2f] px-3 py-1 rounded-lg">Ø§Ù„Ù…ØµØ­Ù</button>
            <button @click="view = 'azkar'" class="text-xs bg-[#053e2f] px-3 py-1 rounded-lg">Ø§Ù„Ø£Ø°ÙƒØ§Ø±</button>
        </div>
    </header>

    <main class="p-4 max-w-xl mx-auto">
        <div v-if="!isDownloaded && view === 'index'" class="bg-white border-2 border-yellow-500 p-4 rounded-2xl mb-6 text-center shadow-lg">
            <p class="mb-3 font-bold text-yellow-800 text-sm">Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ÙŠØ­ØªØ§Ø¬ Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© (4MB)</p>
            <button @click="downloadFullQuran" :disabled="loading" class="bg-yellow-500 text-black font-bold px-6 py-3 rounded-xl w-full active:scale-95 transition">
                {{ loading ? 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„... Ø§Ù†ØªØ¸Ø±' : 'Ø¨Ø¯Ø¡ Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ù„Ù„Ø¹Ù…Ù„ Ø¨Ø¯ÙˆÙ† Ù†Øª' }}
            </button>
        </div>

        <div v-if="view === 'index'">
            <input v-model="search" type="text" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø³ÙˆØ±Ø©..." class="w-full p-4 mb-4 rounded-xl border-none shadow-inner outline-none focus:ring-2 focus:ring-emerald-500">
            <div v-for="s in filteredSurahs" :key="s.number" @click="openSurah(s)" class="card cursor-pointer hover:bg-emerald-50 transition">
                <div class="flex justify-between items-center">
                    <span class="text-lg font-bold">{{ s.number }}. {{ s.name }}</span>
                    <span v-if="isDownloaded" class="text-[10px] text-emerald-600 bg-emerald-50 px-2 py-1 rounded">Ø£ÙˆÙÙ„Ø§ÙŠÙ† âœ…</span>
                </div>
            </div>
        </div>

        <div v-if="view === 'reading' && currentSurah" class="bg-white p-6 rounded-3xl shadow-xl border border-gray-100">
            <h2 class="text-3xl font-bold text-center text-emerald-900 mb-6">{{ currentSurah.name }}</h2>
            <div class="quran-text">
                <span v-for="ayah in currentSurah.ayahs">
                    {{ ayah.text }} <span class="text-sm border border-emerald-200 rounded-full px-1 mx-1">{{ ayah.numberInSurah }}</span>
                </span>
            </div>
            <button @click="view = 'index'" class="btn-main mt-8 bg-gray-200 !text-gray-600">Ø¹ÙˆØ¯Ø© Ù„Ù„ÙÙ‡Ø±Ø³</button>
        </div>

        <div v-if="view === 'azkar'" class="space-y-4">
            <h2 class="text-xl font-bold text-emerald-900 mb-4 border-b pb-2">Ø­ØµÙ† Ø§Ù„Ù…Ø³Ù„Ù…</h2>
            <div v-for="z in azkar" class="card">
                <p class="text-lg leading-relaxed text-gray-800">{{ z.text }}</p>
                <div class="mt-4 flex justify-between items-center">
                    <span class="text-xs font-bold text-emerald-600">Ø§Ù„ØªÙƒØ±Ø§Ø±: {{ z.repeat }}</span>
                    <button @click="z.count > 0 ? z.count-- : null" :class="z.count === 0 ? 'bg-gray-100' : 'bg-emerald-500 text-white'" class="w-10 h-10 rounded-full font-bold">
                        {{ z.count === 0 ? 'âœ…' : z.count }}
                    </button>
                </div>
            </div>
        </div>
    </main>
</div>

<script>
const { createApp, ref, onMounted, computed } = Vue;
createApp({
    setup() {
        const view = ref('index');
        const search = ref('');
        const loading = ref(false);
        const isDownloaded = ref(localStorage.getItem('quran_ready') === 'true');
        const surahs = ref([]);
        const currentSurah = ref(null);

        // Ù†ØµÙˆØµ Ø§Ù„Ø£Ø°ÙƒØ§Ø± ÙƒØ§Ù…Ù„Ø© (Ù…Ø­ÙÙˆØ¸Ø© Ø¯Ø§Ø®Ù„ Ø§Ù„ÙƒÙˆØ¯ Ù„ØªØ¹Ù…Ù„ Ø¨Ø¯ÙˆÙ† Ù†Øª)
        const azkar = ref([
            { text: 'Ø£ÙØµÙ’Ø¨ÙØ­Ù’Ù†ÙØ§ ÙˆÙØ£ÙØµÙ’Ø¨ÙØ­Ù Ø§Ù„Ù’Ù…ÙÙ„Ù’ÙƒÙ Ù„ÙÙ„ÙÙ‘Ù‡ÙØŒ ÙˆÙØ§Ù„Ù’Ø­ÙÙ…Ù’Ø¯Ù Ù„ÙÙ„ÙÙ‘Ù‡ÙØŒ Ù„Ø§Ù Ø¥ÙÙ„ÙÙ‡Ù Ø¥ÙÙ„Ø§ÙÙ‘ Ø§Ù„Ù„ÙÙ‘Ù‡Ù ÙˆÙØ­Ù’Ø¯ÙÙ‡Ù Ù„Ø§Ù Ø´ÙØ±ÙÙŠÙƒÙ Ù„ÙÙ‡ÙØŒ Ù„ÙÙ‡Ù Ø§Ù„Ù’Ù…ÙÙ„Ù’ÙƒÙ ÙˆÙÙ„ÙÙ‡Ù Ø§Ù„Ù’Ø­ÙÙ…Ù’Ø¯Ù ÙˆÙÙ‡ÙÙˆÙ Ø¹ÙÙ„ÙÙ‰ ÙƒÙÙ„ÙÙ‘ Ø´ÙÙŠÙ’Ø¡Ù Ù‚ÙØ¯ÙÙŠØ±ÙŒ.', repeat: 1, count: 1 },
            { text: 'Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ø£ÙÙ†Ù’ØªÙ Ø±ÙØ¨ÙÙ‘ÙŠ Ù„ÙØ§ Ø¥ÙÙ„ÙÙ‡Ù Ø¥ÙÙ„ÙÙ‘Ø§ Ø£ÙÙ†Ù’ØªÙØŒ Ø®ÙÙ„ÙÙ‚Ù’ØªÙÙ†ÙÙŠ ÙˆÙØ£ÙÙ†ÙØ§ Ø¹ÙØ¨Ù’Ø¯ÙÙƒÙØŒ ÙˆÙØ£ÙÙ†ÙØ§ Ø¹ÙÙ„ÙÙ‰ Ø¹Ù‡Ø¯ÙÙƒÙ ÙˆÙÙˆÙØ¹Ù’Ø¯ÙÙƒÙ Ù…ÙØ§ Ø§Ø³Ù’ØªÙØ·ÙØ¹Ù’ØªÙØŒ Ø£ÙØ¹ÙÙˆØ°Ù Ø¨ÙÙƒÙ Ù…ÙÙ†Ù’ Ø´ÙØ±ÙÙ‘ Ù…ÙØ§ ØµÙÙ†ÙØ¹Ù’ØªÙØŒ Ø£ÙØ¨ÙÙˆØ¡Ù Ù„ÙÙƒÙ Ø¨ÙÙ†ÙØ¹Ù’Ù…ÙØªÙÙƒÙ Ø¹ÙÙ„ÙÙŠÙÙ‘ØŒ ÙˆÙØ£ÙØ¨ÙÙˆØ¡Ù Ù„ÙÙƒÙ Ø¨ÙØ°ÙÙ†Ù’Ø¨ÙÙŠ ÙÙØ§ØºÙ’ÙÙØ±Ù’ Ù„ÙÙŠ ÙÙØ¥ÙÙ†ÙÙ‘Ù‡Ù Ù„ÙØ§ ÙŠÙØºÙ’ÙÙØ±Ù Ø§Ù„Ø°ÙÙ‘Ù†ÙÙˆØ¨Ù Ø¥ÙÙ„ÙÙ‘Ø§ Ø£ÙÙ†Ù’ØªÙ.', repeat: 1, count: 1 },
            { text: 'Ø¨ÙØ³Ù’Ù…Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù Ø§Ù„ÙÙ‘Ø°ÙÙŠ Ù„ÙØ§ ÙŠÙØ¶ÙØ±ÙÙ‘ Ù…ÙØ¹Ù Ø§Ø³Ù’Ù…ÙÙ‡Ù Ø´ÙÙŠÙ’Ø¡ÙŒ ÙÙÙŠ Ø§Ù„Ù’Ø£ÙØ±Ù’Ø¶Ù ÙˆÙÙ„ÙØ§ ÙÙÙŠ Ø§Ù„Ø³ÙÙ‘Ù…ÙØ§Ø¡Ù ÙˆÙÙ‡ÙÙˆÙ Ø§Ù„Ø³ÙÙ‘Ù…ÙÙŠØ¹Ù Ø§Ù„Ù’Ø¹ÙÙ„ÙÙŠÙ…Ù.', repeat: 3, count: 3 }
        ]);

        onMounted(async () => {
            if (isDownloaded.value) {
                surahs.value = JSON.parse(localStorage.getItem('quran_content'));
            } else {
                fetchIndex();
            }
        });

        const fetchIndex = async () => {
            try {
                const res = await fetch('https://api.alquran.cloud/v1/surah');
                const data = await res.json();
                surahs.value = data.data;
            } catch (e) { console.log("Offline Mode Active"); }
        };

        const downloadFullQuran = async () => {
            loading.value = true;
            try {
                const res = await fetch('https://api.alquran.cloud/v1/quran/quran-uthmani');
                const data = await res.json();
                localStorage.setItem('quran_content', JSON.stringify(data.data.surahs));
                localStorage.setItem('quran_ready', 'true');
                surahs.value = data.data.surahs;
                isDownloaded.value = true;
                alert("ØªÙ… Ø§Ù„ØªØ­Ù…ÙŠÙ„! Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø³ÙŠØ¹Ù…Ù„ Ø§Ù„Ø¢Ù† Ø£ÙˆÙÙ„Ø§ÙŠÙ† Ø¨Ø§Ù„ÙƒØ§Ù…Ù„.");
            } catch (e) {
                alert("ÙØ´Ù„ Ø§Ù„ØªØ­Ù…ÙŠÙ„. ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª ÙˆØ­Ø§ÙˆÙ„ Ù…Ø¬Ø¯Ø¯Ø§Ù‹.");
            } finally { loading.value = false; }
        };

        const openSurah = (s) => {
            if (isDownloaded.value) {
                currentSurah.value = s;
                view.value = 'reading';
            } else {
                loading.value = true;
                fetch(`https://api.alquran.cloud/v1/surah/${s.number}/quran-uthmani`)
                .then(r => r.json()).then(d => {
                    currentSurah.value = d.data;
                    view.value = 'reading';
                    loading.value = false;
                });
            }
            window.scrollTo(0,0);
        };

        const filteredSurahs = computed(() => surahs.value.filter(s => s.name.includes(search.value)));

        return { view, search, loading, isDownloaded, surahs, currentSurah, azkar, downloadFullQuran, openSurah, filteredSurahs };
    }
}).mount('#app');
</script>
</body>
</html>

